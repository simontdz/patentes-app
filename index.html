<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplicación de Grabado de Patentes</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        body {
            margin: 0;
            padding: 10px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            font-size: 24px;
            margin-top: 10px;
            margin-bottom: 15px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-transform: uppercase;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            flex-grow: 1;
        }
        button:hover {
            background-color: #45a049;
        }
        .preview {
            border: 2px dashed #aaa;
            padding: 20px;
            min-height: 300px;
            margin-top: 20px;
            position: relative;
        }
        .preview-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
            transition: transform 0.3s ease;
            height: 100%;
        }
        .mirror-mode .preview-content {
            transform: scaleX(-1);
        }
        .patente-item {
            font-family: Arial, sans-serif;
            text-transform: uppercase;
            text-align: center;
            line-height: 1.2;
            margin: 5px 0;
            padding: 5px;
            border: 1px dashed transparent;
            cursor: move;
            user-select: none;
            position: relative;
            display: none;
            width: 100%;
        }
        .patente-item.active {
            display: block;
        }
        .patente-item:hover {
            border-color: #aaa;
        }
        #patente-preview {
            font-size: 24pt !important;
            font-weight: bold;
        }
        .logo-container {
            width: 150px;
            height: 100px;
            display: none;
            align-items: center;
            justify-content: center;
            position: relative;
            background-color: transparent;
            margin: 0 auto;
        }
        .logo-container.active {
            display: flex;
        }
        .logo-preview {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .size-control {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 5px;
        }
        .size-slider {
            width: 100%;
        }
        .panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .panel-left {
            width: 100%;
        }
        .panel-right {
            width: 100%;
        }
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-top: 10px;
        }
        .checkbox-group input {
            width: auto;
        }
        .elements-order {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 15px;
        }
        
        /* Media queries para responsividad */
        @media (min-width: 768px) {
            body {
                padding: 20px;
            }
            .container {
                padding: 20px;
            }
            h1 {
                font-size: 28px;
            }
            .panel {
                flex-direction: row;
            }
            .panel-left {
                flex: 1;
            }
            .panel-right {
                flex: 2;
            }
        }
        
        @media print {
            .panel-left, .controls {
                display: none;
            }
            .panel-right {
                width: 100%;
            }
            .preview {
                border: none;
            }
            @page {
                size: auto;
                margin: 0mm;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Aplicación de Grabado de Patentes</h1>
        
        <div class="panel">
            <div class="panel-left">
                <div class="form-group">
                    <label for="marca">Marca de Auto:</label>
                    <select id="marca">
                        <option value="">Seleccione marca</option>
                        <option value="TOYOTA">TOYOTA</option>
                        <option value="FORD">FORD</option>
                        <option value="CHEVROLET">CHEVROLET</option>
                        <option value="VOLKSWAGEN">VOLKSWAGEN</option>
                        <option value="HYUNDAI">HYUNDAI</option>
                        <option value="NISSAN">NISSAN</option>
                        <option value="KIA">KIA</option>
                        <option value="RENAULT">RENAULT</option>
                        <option value="PEUGEOT">PEUGEOT</option>
                        <option value="FIAT">FIAT</option>
                        <option value="OTRO">OTRA MARCA</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="patente">Número de Patente:</label>
                    <input type="text" id="patente" placeholder="Ingrese número de patente">
                </div>
                
                <div class="form-group">
                    <label for="chasis">Número de Chasis:</label>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="text" id="chasis" placeholder="Ingrese número de chasis" style="flex: 1;">
                        <button id="toggle-chasis" style="flex: 0 0 auto;">Ocultar</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="logo">Logo:</label>
                    <input type="file" id="logo" accept="image/*">
                </div>
                
                <div class="size-control">
                    <label for="marca-size">Tamaño de Marca:</label>
                    <input type="range" id="marca-size" class="size-slider" min="8" max="36" value="14">
                    <span id="marca-size-value">14pt</span>
                </div>
                
                <div class="size-control">
                    <label for="patente-size">Tamaño de Patente:</label>
                    <input type="range" id="patente-size" class="size-slider" min="24" max="48" value="32">
                    <span id="patente-size-value">32pt</span>
                </div>
                
                <div class="size-control">
                    <label for="chasis-size">Tamaño de Chasis:</label>
                    <input type="range" id="chasis-size" class="size-slider" min="8" max="36" value="12">
                    <span id="chasis-size-value">12pt</span>
                </div>
                
                <div class="size-control">
                    <label for="logo-size">Tamaño de Logo:</label>
                    <input type="range" id="logo-size" class="size-slider" min="50" max="300" value="150">
                    <span id="logo-size-value">150px</span>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="mirror-mode">
                    <label for="mirror-mode">Modo Espejo</label>
                </div>
            </div>
            
            <div class="panel-right">
                <div class="controls">
                    <button id="btn-print">Imprimir</button>
                    <button id="btn-download">Descargar Imagen</button>
                </div>
                
                <div class="preview">
                    <div class="preview-content" id="preview-content">
                        <div class="logo-container" id="logo-container">
                            <img src="" alt="Logo" class="logo-preview" id="logo-preview">
                        </div>
                        <div class="patente-item" id="marca-preview"></div>
                        <div class="patente-item" id="patente-preview"></div>
                        <div class="patente-item" id="chasis-preview"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Referencias a elementos del DOM
        const marcaInput = document.getElementById('marca');
        const chasisInput = document.getElementById('chasis');
        const patenteInput = document.getElementById('patente');
        const logoInput = document.getElementById('logo');
        const marcaPreview = document.getElementById('marca-preview');
        const chasisPreview = document.getElementById('chasis-preview');
        const patentePreview = document.getElementById('patente-preview');
        const logoPreview = document.getElementById('logo-preview');
        const logoContainer = document.getElementById('logo-container');
        const previewContent = document.getElementById('preview-content');
        const mirrorMode = document.getElementById('mirror-mode');
        const printBtn = document.getElementById('btn-print');
        const downloadBtn = document.getElementById('btn-download');
        const toggleChasisBtn = document.getElementById('toggle-chasis');
        
        // Controles de tamaño
        const marcaSize = document.getElementById('marca-size');
        const chasisSize = document.getElementById('chasis-size');
        const patenteSize = document.getElementById('patente-size');
        const logoSize = document.getElementById('logo-size');
        const marcaSizeValue = document.getElementById('marca-size-value');
        const chasisSizeValue = document.getElementById('chasis-size-value');
        const patenteSizeValue = document.getElementById('patente-size-value');
        const logoSizeValue = document.getElementById('logo-size-value');

        // Estado de visibilidad del chasis
        let chasisVisible = true;

        // Función para actualizar la vista previa
        function updatePreview() {
            // Actualizar marca
            const marcaValue = marcaInput.value.trim().toUpperCase();
            if (marcaValue) {
                marcaPreview.textContent = marcaValue;
                marcaPreview.classList.add('active');
            } else {
                marcaPreview.textContent = '';
                marcaPreview.classList.remove('active');
            }
            
            // Actualizar patente
            const patenteValue = patenteInput.value.trim().toUpperCase();
            if (patenteValue) {
                patentePreview.textContent = patenteValue;
                patentePreview.classList.add('active');
            } else {
                patentePreview.textContent = '';
                patentePreview.classList.remove('active');
            }
            
            // Actualizar chasis
            const chasisValue = chasisInput.value.trim().toUpperCase();
            if (chasisValue && chasisVisible) {
                chasisPreview.textContent = chasisValue;
                chasisPreview.classList.add('active');
            } else {
                chasisPreview.textContent = '';
                chasisPreview.classList.remove('active');
            }
        }

        // Event listeners para inputs
        marcaInput.addEventListener('input', updatePreview);
        chasisInput.addEventListener('input', updatePreview);
        patenteInput.addEventListener('input', updatePreview);
        
        // Event listener para logo
        logoInput.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    logoPreview.src = event.target.result;
                    logoContainer.classList.add('active');
                };
                reader.readAsDataURL(file);
            } else {
                logoPreview.src = '';
                logoContainer.classList.remove('active');
            }
        });
        
        // Event listeners para controles de tamaño
        marcaSize.addEventListener('input', function() {
            marcaPreview.style.fontSize = this.value + 'pt';
            marcaSizeValue.textContent = this.value + 'pt';
        });
        
        patenteSize.addEventListener('input', function() {
            patentePreview.style.fontSize = this.value + 'pt';
            patenteSizeValue.textContent = this.value + 'pt';
        });
        
        chasisSize.addEventListener('input', function() {
            chasisPreview.style.fontSize = this.value + 'pt';
            chasisSizeValue.textContent = this.value + 'pt';
        });
        
        logoSize.addEventListener('input', function() {
            const size = this.value;
            logoContainer.style.width = size + 'px';
            logoContainer.style.height = (size * 2/3) + 'px';
            logoSizeValue.textContent = size + 'px';
        });
        
        // Modo espejo
        mirrorMode.addEventListener('change', function() {
            if (this.checked) {
                document.querySelector('.preview').classList.add('mirror-mode');
            } else {
                document.querySelector('.preview').classList.remove('mirror-mode');
            }
        });
        
        // Función de impresión
        printBtn.addEventListener('click', function() {
            window.print();
        });
        
        // Función para descargar como imagen
        downloadBtn.addEventListener('click', function() {
            // Ocultar elementos no deseados en la captura
            const preview = document.querySelector('.preview');
            const originalBorder = preview.style.border;
            preview.style.border = 'none';
            
            // Usar html2canvas para capturar el contenido
            html2canvas(preview).then(canvas => {
                // Restaurar el borde
                preview.style.border = originalBorder;
                
                // Crear enlace de descarga
                const link = document.createElement('a');
                link.download = 'grabado-patente.png';
                link.href = canvas.toDataURL('image/png');
                link.click();
            });
        });

        // Función para mostrar/ocultar chasis
        toggleChasisBtn.addEventListener('click', function() {
            chasisVisible = !chasisVisible;
            this.textContent = chasisVisible ? 'Ocultar' : 'Mostrar';
            updatePreview();
        });

        // Posicionar elementos en el orden deseado
        function positionElements() {
            const elements = [
                { id: 'logo-container', top: '20px' },
                { id: 'marca-preview', top: 'calc(20px + 100px + 20px)' },
                { id: 'patente-preview', top: 'calc(20px + 100px + 20px + 50px)' },
                { id: 'chasis-preview', top: 'calc(20px + 100px + 20px + 50px + 60px)' }
            ];

            elements.forEach(el => {
                const element = document.getElementById(el.id);
                if (element) {
                    element.style.position = 'absolute';
                    element.style.left = '50%';
                    element.style.transform = 'translateX(-50%)';
                    element.style.top = el.top;
                }
            });
        }

        // Inicializar tamaños
        marcaPreview.style.fontSize = marcaSize.value + 'pt';
        patentePreview.style.fontSize = patenteSize.value + 'pt';
        chasisPreview.style.fontSize = chasisSize.value + 'pt';
        
        // Posicionar elementos al cargar la página
        window.addEventListener('load', function() {
            positionElements();
            updatePreview();
        });

        // Reposicionar elementos al cambiar el tamaño de la ventana
        window.addEventListener('resize', positionElements);
    </script>
    
    <!-- Incluir html2canvas para la captura de pantalla -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</body>
</html>